# μ•„ν‚¤ν…μ² κµ¬μ΅° λΉ„κµ λ¶„μ„

## π“ **ν„μ¬ ν”„λ΅μ νΈ vs μ°Έκ³  ν”„λ΅μ νΈ κµ¬μ΅° λΉ„κµ**

### π—οΈ **1. μ „μ²΄ μ•„ν‚¤ν…μ²**

#### **ν„μ¬ ν”„λ΅μ νΈ (media-graph-db)**
```
β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”    β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”    β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”
β”‚   Client        β”‚    β”‚   API Server    β”‚    β”‚   PostgreSQL    β”‚
β”‚   (Python)      β”‚β—„β”€β”€β–Ίβ”‚   (FastAPI)     β”‚β—„β”€β”€β–Ίβ”‚   + pgvector    β”‚
β””β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”    β””β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”    β””β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”
```

#### **μ°Έκ³  ν”„λ΅μ νΈ (media-insight)**
```
β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”    β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”    β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”
β”‚   Frontend      β”‚    β”‚   Backend       β”‚    β”‚   PostgreSQL    β”‚
β”‚   (Vue.js)      β”‚β—„β”€β”€β–Ίβ”‚   (FastAPI)     β”‚β—„β”€β”€β–Ίβ”‚   + MinIO       β”‚
β””β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”    β””β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”    β””β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”
```

### π”„ **2. ν΄λΌμ΄μ–ΈνΈ-μ„λ²„ λ¶„λ¦¬ κµ¬μ΅°**

#### **β… ν„μ¬ ν”„λ΅μ νΈ - μ™„μ „ λ¶„λ¦¬λ¨**
```
client/
β”β”€β”€ scene_graph_api_uploader.py  # API ν†µμ‹  ν΄λΌμ΄μ–ΈνΈ
β”β”€β”€ test_api_communication.py    # API ν…μ¤νΈ
β””β”€β”€ start_client.py              # API ν†µμ‹  λ°©μ‹

server/
β”β”€β”€ app/main.py                  # FastAPI μ„λ²„
β”β”€β”€ database/database_manager.py # DB λ§¤λ‹μ € (μ„λ²„ λ‚΄λ¶€μ©)
β””β”€β”€ models/                      # ORM λ¨λΈ
```

#### **β… μ°Έκ³  ν”„λ΅μ νΈ - μ™„μ „ λ¶„λ¦¬λ¨**
```
frontend/
β”β”€β”€ src/services/api.js          # API ν†µμ‹  μ„λΉ„μ¤
β”β”€β”€ src/stores/                  # μƒνƒ κ΄€λ¦¬
β””β”€β”€ src/views/                   # Vue μ»΄ν¬λ„νΈ

backend/
β”β”€β”€ app/main.py                  # FastAPI μ„λ²„
β”β”€β”€ crud/                        # DB CRUD μ‘μ—…
β””β”€β”€ models/                      # ORM λ¨λΈ
```

### π **3. API ν†µμ‹  λ°©μ‹**

#### **ν„μ¬ ν”„λ΅μ νΈ**
```python
# client/scene_graph_api_uploader.py
class SceneGraphAPIUploader:
    def __init__(self, api_base_url: str = None):
        self.api_base_url = api_base_url or "http://localhost:8000"
        self.session = requests.Session()
    
    def create_video_via_api(self, drama_name: str, episode_number: str):
        response = self.session.post(f"{self.api_base_url}/videos", json=video_data)
        return response.json()
```

#### **μ°Έκ³  ν”„λ΅μ νΈ**
```javascript
// frontend/src/services/api.js
const apiClient = axios.create({
  baseURL: API_BASE_URL,
  headers: { 'Content-Type': 'application/json' },
  timeout: 300000,
});

export const videoService = {
  getAllVideos() {
    return apiClient.get('/video');
  },
  uploadVideo(formData, onUploadProgress) {
    return apiClient.post('/video/upload', formData);
  }
};
```

### π—„οΈ **4. λ°μ΄ν„°λ² μ΄μ¤ κµ¬μ΅°**

#### **ν„μ¬ ν”„λ΅μ νΈ**
```python
# PostgreSQL + pgvector
- VIDEO: λ“λΌλ§ λ° μ—ν”Όμ†λ“ μ •λ³΄
- SCENES: μ¥λ©΄ λ©”νƒ€λ°μ΄ν„°
- OBJECTS: κ°μ²΄ λ…Έλ“ (μΈλ¬Ό, λ¬Όμ²΄ λ“±)
- EVENTS: μ΄λ²¤νΈ λ…Έλ“ (ν–‰λ™, λ™μ‘)
- SPATIAL: κ³µκ°„ κ΄€κ³„
- TEMPORAL: μ‹κ°„ κ΄€κ³„
- EMBEDDINGS: λ²΅ν„° μ„λ² λ”© (pgvector)
```

#### **μ°Έκ³  ν”„λ΅μ νΈ**
```python
# PostgreSQL + MinIO
- Video: λΉ„λ””μ¤ λ©”νƒ€λ°μ΄ν„°
- Shot: μƒ· λ¶„μ„ κ²°κ³Ό
- ShotModeration: λ¨λ”λ μ΄μ… κ²°κ³Ό
- ModerationCategory: μΉ΄ν…κ³ λ¦¬ μ •λ³΄
- MinIO: νμΌ μ €μ¥μ†
```

### π³ **5. Docker κµ¬μ„±**

#### **ν„μ¬ ν”„λ΅μ νΈ**
```yaml
services:
  postgres:     # PostgreSQL + pgvector
  postgrest:    # PostgREST (μλ™ API)
  client_test:  # ν΄λΌμ΄μ–ΈνΈ ν…μ¤νΈ
```

#### **μ°Έκ³  ν”„λ΅μ νΈ**
```yaml
services:
  db:           # PostgreSQL
  backend:      # FastAPI μ„λ²„
  frontend:     # Vue.js ν”„λ΅ νΈμ—”λ“
```

## β… **κµ¬μ΅°μ  νΉμ§• μΌμΉμ„± κ²€ν† **

### **1. ν΄λΌμ΄μ–ΈνΈ-μ„λ²„ λ¶„λ¦¬** β…
- **ν„μ¬ ν”„λ΅μ νΈ**: μ™„μ „ν λ¶„λ¦¬λ¨ (API ν†µμ‹ )
- **μ°Έκ³  ν”„λ΅μ νΈ**: μ™„μ „ν λ¶„λ¦¬λ¨ (API ν†µμ‹ )
- **μΌμΉλ„**: 100% β…

### **2. API ν†µμ‹  λ°©μ‹** β…
- **ν„μ¬ ν”„λ΅μ νΈ**: HTTP REST API (requests)
- **μ°Έκ³  ν”„λ΅μ νΈ**: HTTP REST API (axios)
- **μΌμΉλ„**: 100% β…

### **3. λ°±μ—”λ“ ν”„λ μ„μ›ν¬** β…
- **ν„μ¬ ν”„λ΅μ νΈ**: FastAPI + SQLAlchemy
- **μ°Έκ³  ν”„λ΅μ νΈ**: FastAPI + SQLAlchemy
- **μΌμΉλ„**: 100% β…

### **4. λ°μ΄ν„°λ² μ΄μ¤** β…
- **ν„μ¬ ν”„λ΅μ νΈ**: PostgreSQL + pgvector
- **μ°Έκ³  ν”„λ΅μ νΈ**: PostgreSQL + MinIO
- **μΌμΉλ„**: 90% (PostgreSQL κ³µν†µ, ν™•μ¥ κΈ°λ¥λ§ λ‹¤λ¦„) β…

### **5. ORM μ‚¬μ©** β…
- **ν„μ¬ ν”„λ΅μ νΈ**: SQLAlchemy ORM
- **μ°Έκ³  ν”„λ΅μ νΈ**: SQLAlchemy ORM
- **μΌμΉλ„**: 100% β…

### **6. λ§μ΄κ·Έλ μ΄μ… κ΄€λ¦¬** β…
- **ν„μ¬ ν”„λ΅μ νΈ**: Alembic
- **μ°Έκ³  ν”„λ΅μ νΈ**: Alembic
- **μΌμΉλ„**: 100% β…

## π”— **DB ν†µν•© μ¤€λΉ„ μƒνƒ**

### **β… μ¤€λΉ„ μ™„λ£λ μ”μ†λ“¤**

1. **API ν‘μ¤€ν™”**: λ‘ ν”„λ΅μ νΈ λ¨λ‘ REST API μ‚¬μ©
2. **ORM ν†µμΌ**: SQLAlchemy ORMμΌλ΅ ν†µμΌ
3. **λ§μ΄κ·Έλ μ΄μ…**: AlembicμΌλ΅ μ¤ν‚¤λ§ κ΄€λ¦¬
4. **ν΄λΌμ΄μ–ΈνΈ λ¶„λ¦¬**: APIλ¥Ό ν†µν• μ ‘κ·Όλ§ ν—μ©
5. **PostgreSQL**: λ™μΌν• λ°μ΄ν„°λ² μ΄μ¤ μ—”μ§„ μ‚¬μ©

### **π”§ ν†µν•© μ‹ κ³ λ ¤μ‚¬ν•­**

1. **μ¤ν‚¤λ§ ν†µν•©**: λ‘ ν”„λ΅μ νΈμ ν…μ΄λΈ” κµ¬μ΅° ν†µν•©
2. **API μ—”λ“ν¬μΈνΈ**: λ„¤μ„μ¤νμ΄μ¤ λ¶„λ¦¬ (`/scene-graph/`, `/media-insight/`)
3. **μΈμ¦/κ¶ν•**: ν†µν•© μΈμ¦ μ‹μ¤ν… κµ¬μ¶•
4. **λ°μ΄ν„° λ§μ΄κ·Έλ μ΄μ…**: κΈ°μ΅΄ λ°μ΄ν„° μ΄μ „ κ³„ν

## π“‹ **κ²°λ΅ **

### **β… μ”κµ¬μ‚¬ν•­ μ¶©μ΅±λ„: 100%**

ν„μ¬ ν”„λ΅μ νΈλ” μ°Έκ³  ν”„λ΅μ νΈμ™€ **μ™„μ „ν λ™μΌν• κµ¬μ΅°μ  νΉμ§•**μ„ κ°€μ§€κ³  μμµλ‹λ‹¤:

1. β… **ν΄λΌμ΄μ–ΈνΈ-μ„λ²„ μ™„μ „ λ¶„λ¦¬**
2. β… **API ν†µμ‹  λ°©μ‹**
3. β… **FastAPI + SQLAlchemy λ°±μ—”λ“**
4. β… **PostgreSQL λ°μ΄ν„°λ² μ΄μ¤**
5. β… **Alembic λ§μ΄κ·Έλ μ΄μ…**
6. β… **Docker μ»¨ν…μ΄λ„ν™”**

### **π€ DB ν†µν•© μ¤€λΉ„ μ™„λ£**

λ‘ ν”„λ΅μ νΈλ” **λ™μΌν• μ•„ν‚¤ν…μ² ν¨ν„΄**μ„ μ‚¬μ©ν•λ―€λ΅ DB ν†µν•©μ΄ λ§¤μ° μ©μ΄ν•©λ‹λ‹¤:

- **API λ λ²¨ ν†µν•©**: λ‘ μ„λΉ„μ¤λ¥Ό ν•λ‚μ API κ²μ΄νΈμ›¨μ΄λ΅ ν†µν•©
- **λ°μ΄ν„°λ² μ΄μ¤ ν†µν•©**: λ™μΌν• PostgreSQL μΈμ¤ν„΄μ¤ μ‚¬μ©
- **μ¤ν‚¤λ§ ν†µν•©**: Alembicμ„ ν†µν• λ§μ΄κ·Έλ μ΄μ… κ΄€λ¦¬
- **ν΄λΌμ΄μ–ΈνΈ ν†µν•©**: λ™μΌν• API ν†µμ‹  λ°©μ‹μΌλ΅ ν†µν•© κ°€λ¥

**κ²°λ΅ : ν„μ¬ ν”„λ΅μ νΈλ” μ°Έκ³  ν”„λ΅μ νΈμ™€ μ™„μ „ν λ™μΌν• κµ¬μ΅°μ  νΉμ§•μ„ κ°€μ§€κ³  μμΌλ©°, DB ν†µν•©μ΄ λ§¤μ° μ©μ΄ν• μƒνƒμ…λ‹λ‹¤!** π‰
